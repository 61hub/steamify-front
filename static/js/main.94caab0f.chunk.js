(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{109:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(10),s=t.n(c),i=t(12),o=t(7),l=t(36),m=t.n(l),p=t(51),u=t(25),d=t(26),f=t(29),h=t(27),v=t(30),E=t(11),g=t.n(E),b=function(e){var a=0;if(!e.items&&e.dlc.length>0&&e.dlc.forEach(function(e){a+=e.price}),"pack"===e.type){var t=0;return console.log(e.games),e.games.forEach(function(e){return t+=e.playtimeForever}),t<=60?e.price:(console.log(e.price,t/60),Math.round(e.price/t/60))}if(e.playtimeForever<=60)return e.price+a;var n=e.playtimeForever/60;return(e.price+a)/n},O=function(e){var a=Math.floor(e/60),t=e%60;return t>10&&t.toString().length<2&&(t*=10),a?t?"".concat(a,"h ").concat(t,"m"):"".concat(a,"h"):"".concat(t,"m")},k=function(e){var a=e.price;return e.dlc&&e.dlc.length&&e.dlc.forEach(function(e){return a+=e.price}),a},S=function(e){function a(e){var t;return Object(u.a)(this,a),(t=Object(f.a)(this,Object(h.a)(a).call(this,e))).handleInputSubmit=function(e,a){13===e.keyCode?t.props.saveData(a,t.state.value):t.setState({value:e.target.value})},t.handleDlc=function(e,a){13===e.keyCode&&t.props.saveDataDlc(a,t.dlcNameRef.current.value,t.dlcPriceRef.current.value)},t.definePriceHourClassName=function(e){var a=b(e);return a<=10?"darkGreen":a<=50?"green":a<=100?"yellow":a<=200?"orange":a>=200?"red":void 0},t.hideGame=function(e){t.setState({gameClassName:"hide",hidden:!0},function(){g.a.patch("http://steamify-api.61hub.com/v1/games/".concat(e),{hidden:t.state.hidden})})},t.openDlc=function(e){"dlcWrapper"==t.state.dlcClassName?t.setState({dlcClassName:"dlcWrapperHidden"}):t.setState({dlcClassName:"dlcWrapper"})},t.patchSubmitedData=function(e,a){a.preventDefault();e.toString();var n=t.selectRef.current.options[t.selectRef.current.selectedIndex].value,r=t.props.packages.find(function(e){return e.packId==n});g.a.patch("http://steamify-api.61hub.com/v1/packs/".concat(n),{items:Object(o.a)(r.items).concat([e])}).then(function(){t.props.onAddedToPack(),t.hideGame(e)})},t.dlcNameRef=r.a.createRef(),t.dlcPriceRef=r.a.createRef(),t.selectRef=r.a.createRef(),t.state={value:"",hidden:e.data.hidden,dlcClassName:"dlcWrapperHidden"},t}return Object(v.a)(a,e),Object(d.a)(a,[{key:"render",value:function(){var e=this,a=this.props.data;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"gameWrapper ".concat(this.state.hidden?"hidden":"")},r.a.createElement("div",{className:"gameIcon"},r.a.createElement("img",{src:a.logo})),r.a.createElement("div",{className:"gameInformation"},r.a.createElement("div",{className:"gameName",onClick:function(a){return e.openDlc(a)}},a.name),r.a.createElement("div",{className:"gameMinorInfo"},r.a.createElement("div",{className:"gameHourPrice ".concat(this.definePriceHourClassName(a))}),r.a.createElement("div",{className:"gameIndex"},"#",this.props.index+1),r.a.createElement("div",{className:"gameTotalPrice"},a.totalPrice,"P"))),r.a.createElement("div",{className:"gameDuration"},O(a.playtimeForever))),r.a.createElement("div",{className:"".concat(this.state.dlcClassName," options")},r.a.createElement("div",null,r.a.createElement("input",{className:"priceInput",defaultValue:a.price,type:"number",onKeyUp:function(t){return e.handleInputSubmit(t,a.appId,a.playtimeForever)}})),r.a.createElement("div",{className:"hideButton"},r.a.createElement("button",{onClick:function(){return e.hideGame(a.appId)}},"Hide")),r.a.createElement("div",{className:"dropDownPacks"},"pack"!==a.type&&r.a.createElement("form",{onSubmit:function(t){return e.patchSubmitedData(a.appId,t)}},r.a.createElement("select",{ref:this.selectRef},this.props.packages&&this.props.packages.map(function(e){return r.a.createElement("option",{value:e.packId},e.name)})),r.a.createElement("button",null,"Package")))),r.a.createElement("div",{className:this.state.dlcClassName},"pack"===a.type?r.a.createElement("div",{className:"packWrapper"},a.games.map(function(e){return r.a.createElement("div",null,r.a.createElement("div",null,e.name),r.a.createElement("div",null,O(e.playtimeForever)))})):r.a.createElement(r.a.Fragment,null,a.dlc&&a.dlc.map(function(e){return r.a.createElement("div",{className:"dlc"},r.a.createElement("div",{className:"dlcName"},e.name),r.a.createElement("div",null,e.price))}),r.a.createElement("div",null,r.a.createElement("input",{className:"dlcInput",placeholder:"DLC name",type:"text",onKeyUp:function(t){return e.handleDlc(t,a.appId)},ref:this.dlcNameRef})),r.a.createElement("div",null,r.a.createElement("input",{className:"dlcInput",placeholder:"DLC price",type:"text",onKeyUp:function(t){return e.handleDlc(t,a.appId)},ref:this.dlcPriceRef})))))}}]),a}(n.Component),y=t(52),N=t(28),C=t(110),D=t(113),I=t(23),j=t(107),P=(t(90),t(92),t(94),t(96),function(e){var a=e.games,t=e.packs,n=0,c=0;return a.forEach(function(e){e.hidden||(n+=k(e),c+=e.playtimeForever)}),t.forEach(function(e){n+=e.price,c+=e.playtimeForever}),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"stats"},r.a.createElement("div",null,"Total price: ".concat(n,"P")),r.a.createElement("div",null,"Total playtime: ".concat(Math.round(c/60),"hrs"))),r.a.createElement("div",{className:"twoWeeks"},r.a.createElement("h3",null,"Two weeks leaders:"),a.filter(function(e){return e.playtimeTwoWeeks}).sort(function(e,a){return a.playtimeTwoWeeks-e.playtimeTwoWeeks}).map(function(e){var a=Object(i.a)({},e);return a.playtimeForever=a.playtimeTwoWeeks,a}).map(function(e,a){return r.a.createElement(S,{data:e,index:a},e.name," ",O(e.playtimeTwoWeeks))})))}),T=t(112),w=t(108),F=t(32),R=function(e){var a=e.isOpen,t=e.onClose,n=e.serverStatus,c=e.onSortChange,s=e.sortedBy,i=e.sortOrder,o=e.onSortOrderChange,l=e.addPack;return r.a.createElement(D.a,{isOpen:a,onClose:t,autoFocus:!0,canEscapeKeyClose:!0,canOutsideClickClose:!0,enforceFocus:!0,hasBackdrop:!0,position:I.a.RIGHT,usePortal:!0,size:D.a.SIZE_SMALL},r.a.createElement("div",{className:j.a.DRAWER_BODY},r.a.createElement("div",{className:j.a.DIALOG_BODY},r.a.createElement("div",{className:"loadingState ".concat(n)}),r.a.createElement(T.a,{label:"Sort by:",onChange:c,selectedValue:s},r.a.createElement(w.a,{label:"Price",value:"totalPrice"}),r.a.createElement(w.a,{label:"Hours",value:"playtimeForever"}),r.a.createElement(w.a,{label:"Price per hour",value:"pricePerHour"})),r.a.createElement(T.a,{label:"Order:",onChange:o,selectedValue:i},r.a.createElement(w.a,{label:"Asc",value:"asc"}),r.a.createElement(w.a,{label:"Desc",value:"desc"})),r.a.createElement(F.b,{onSubmit:l,render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(F.a,{name:"packName",component:"input",type:"text",placeholder:"Package name"}),r.a.createElement(F.a,{name:"packPrice",component:"input",type:"number",placeholder:"Package price"}),r.a.createElement("button",{type:"submit"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))}}))))},_="FETCH_GAMES_SUCCESS",B=function(){return function(e){return g.a.get("http://steamify-api.61hub.com/v1/games").then(function(a){return e((t=a.data,{type:_,games:t}));var t})}},G="FETCH_PACKS_SUCCESS",W=function(){return function(e){return g.a.get("http://steamify-api.61hub.com/v1/packs").then(function(a){return e((t=a.data,{type:G,packs:t}));var t})}},H=function(e){function a(){var e,t;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(t=Object(f.a)(this,(e=Object(h.a)(a)).call.apply(e,[this].concat(r)))).state={serverStatus:"",sortedBy:"playtimeForever",sortOrder:"desc",isSettingsOpen:!1,isStatsOpen:!1},t.fetchData=Object(p.a)(m.a.mark(function e(){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.props.fetchGames();case 2:return e.next=4,t.props.fetchPacks();case 4:case"end":return e.stop()}},e,this)})),t.saveData=function(e,a){t.setState({serverStatus:"loading"}),a=parseInt(a),g.a.patch("http://steamify-api.61hub.com/v1/games/".concat(e),{price:a}).then(function(e){return t.setState({serverStatus:"success"})}).catch(function(e){return t.setState({serverStatus:"error"})}),t.props.gameUpdate({appId:e,price:a})},t.saveDataDlc=function(e,a,n){var r=Object(o.a)(t.props.games),c=r.find(function(a){return a.appId==e});t.setState({serverStatus:"loading"}),g.a.patch("http://steamify-api.61hub.com/v1/games/".concat(e),{dlc:Object(o.a)(c.dlc).concat([{name:a,price:n}])}).then(function(e){return t.setState({serverStatus:"success"})}).catch(function(e){return t.setState({serverStatus:"error"})});var s=r.findIndex(function(a){return a.appId==e}),l=Object(i.a)({},c);l.dlc=Object(o.a)(l.dlc).concat([{name:a,price:n}]),r[s]=l,t.props.dispatchGamesToStore(r)},t.addPack=function(e){var a=e.packName,t=e.packPrice;g.a.post("http://steamify-api.61hub.com/v1/packs",{name:a,price:t})},t}return Object(v.a)(a,e),Object(d.a)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this,a=this.props,t=a.games,n=a.packs;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"controls"},r.a.createElement(C.a,{className:"bp3-minimal",onClick:function(){return e.setState({isSettingsOpen:!0})},icon:"settings"}),r.a.createElement(C.a,{className:"bp3-minimal",onClick:function(){return e.setState({isStatsOpen:!0})},icon:"grouped-bar-chart"}),r.a.createElement(C.a,{className:"bp3-minimal",onClick:this.fetchData,icon:"refresh"})),r.a.createElement(R,{isOpen:this.state.isSettingsOpen,onClose:function(){return e.setState({isSettingsOpen:!1})},serverStatus:this.state.serverStatus,onSortChange:function(a){return e.setState({sortedBy:a.currentTarget.value})},sortedBy:this.state.sortedBy,sortOrder:this.state.sortOrder,onSortOrderChange:function(a){return e.setState({sortOrder:a.currentTarget.value})},addPack:this.addPack}),r.a.createElement(D.a,{isOpen:this.state.isStatsOpen,onClose:function(){return e.setState({isStatsOpen:!1})},autoFocus:!0,canEscapeKeyClose:!0,canOutsideClickClose:!0,enforceFocus:!0,hasBackdrop:!0,position:I.a.RIGHT,usePortal:!0,size:D.a.SIZE_LARGE},r.a.createElement("div",{className:j.a.DRAWER_BODY},r.a.createElement("div",{className:j.a.DIALOG_BODY},r.a.createElement(P,{games:Object(o.a)(this.props.games),packs:Object(o.a)(this.props.packs)})))),r.a.createElement("div",{className:"mainWrapper"},y.orderBy(Object(o.a)(n).concat(Object(o.a)(t)),[this.state.sortedBy,"playtimeForever"],[this.state.sortOrder]).filter(function(e){return!e.hidden}).map(function(a,t){return r.a.createElement(S,{key:a.appId,data:a,index:t,saveData:e.saveData,saveDataDlc:e.saveDataDlc,packages:e.props.games.filter(function(e){return e.items}),packId:e.state.packId,onAddedToPack:e.fetchGamesData})})))}}]),a}(n.Component),x=Object(N.b)(function(e){return{games:e.games,packs:e.packs}},function(e){return{fetchGames:function(){return e(B())},fetchPacks:function(){return e(W())},gameUpdate:function(a){e({type:"gameUpdate",game:a})},dispatchGamesToStore:function(a){e({data:a,type:"gamesToStore"})}}})(H),A=t(19),U=t(39),L=window.__REDUX_DEVTOOLS_EXTENSION__?Object(A.c)(Object(A.a)(U.a),window.__REDUX_DEVTOOLS_EXTENSION__()):Object(A.a)(U.a),M=Object(A.d)(function(e,a){switch(a.type){case _:return a.games.forEach(function(e){isNaN(parseInt(e.price))?e.price=0:e.price=parseInt(e.price),e.pricePerHour=b(e),e.totalPrice=k(e)}),Object(i.a)({},e,{games:a.games});case G:var t=a.packs;return t.forEach(function(a){a.games=[],a.type="pack",a.items.forEach(function(t){var n=e.games.find(function(e){return e.appId===parseInt(t)});n&&a.games.push(n)}),a.playtimeForever=0,a.games&&a.games.length&&(a.games.forEach(function(e){return a.playtimeForever+=e.playtimeForever}),a.logo=a.games[Math.floor(Math.random()*(a.games.length-1))].logo,a.pricePerHour=b(a)),a.totalPrice=a.price}),Object(i.a)({},e,{packs:t});case"gamesToStore":return Object(i.a)({},e,{games:Object(o.a)(e.games).concat(Object(o.a)(a.data))});case"gameUpdate":var n=e.games.map(function(e){return e.appId===a.game.appId?Object(i.a)({},e,a.game):e});return Object(i.a)({},e,{games:n});case"packsToStore":return Object(i.a)({},e,{games:Object(o.a)(e.games).concat(Object(o.a)(a.packs))})}return{games:[],packs:[]}},L);s.a.render(r.a.createElement(N.a,{store:M},r.a.createElement(x,null)),document.getElementById("root"))},60:function(e,a,t){e.exports=t(109)},96:function(e,a,t){}},[[60,2,1]]]);
//# sourceMappingURL=main.94caab0f.chunk.js.map